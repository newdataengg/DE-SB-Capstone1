Starting ADLS Gen2 data ingestion process...
Attempting to mount wasbs://input@springboardcapstone1st.blob.core.windows.net/ to /mnt/adlsgen2
✓ Storage already mounted
✓ Mount verification successful - found 2 items in root
Found 1 .txt files in CSV Directory 1 (NYSE 2020-08-05)

--- Processing CSV Directory 1 (NYSE 2020-08-05) ---
Found 300 lines in CSV Directory 1 (NYSE 2020-08-05)
Sample raw lines:
+------------------------------------------------------------------------------------------------------------------+
|value                                                                                                             |
+------------------------------------------------------------------------------------------------------------------+
|2020-08-05,2020-08-05 09:30:00.0,Q,SYMA,2020-08-05 09:34:51.505,1,NYSE,75.30254839137037,100,75.35916738004924,100|
|2020-08-05,2020-08-05 09:30:00.0,Q,SYMA,2020-08-05 09:40:52.586,2,NYSE,77.20874619466693,100,78.90918015646369,100|
|2020-08-05,2020-08-05 09:30:00.0,Q,SYMA,2020-08-05 09:50:04.681,3,NYSE,77.15973273251218,100,77.3320469411047,100 |
+------------------------------------------------------------------------------------------------------------------+
only showing top 3 rows

✓ Successfully processed 300 records from CSV Directory 1 (NYSE 2020-08-05)
Sample processed data:
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|trade_dt  |file_tm              |record_type|symbol|event_tm               |event_seq_nb|exchange|bid_pr|bid_size|ask_pr|ask_size|partition|
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 09:34:51.505|1           |NYSE    |75.30 |100     |75.36 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 09:40:52.586|2           |NYSE    |77.21 |100     |78.91 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 09:50:04.681|3           |NYSE    |77.16 |100     |77.33 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 09:57:46.343|4           |NYSE    |79.30 |100     |80.08 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 10:06:50.886|5           |NYSE    |77.86 |100     |78.31 |100     |Q        |
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
only showing top 5 rows

Found 1 .txt files in CSV Directory 2 (NYSE 2020-08-06)

--- Processing CSV Directory 2 (NYSE 2020-08-06) ---
Found 300 lines in CSV Directory 2 (NYSE 2020-08-06)
Sample raw lines:
+------------------------------------------------------------------------------------------------------------------+
|value                                                                                                             |
+------------------------------------------------------------------------------------------------------------------+
|2020-08-06,2020-08-06 09:30:00.0,Q,SYMA,2020-08-06 09:39:01.293,1,NYSE,77.67912845315918,100,78.43735795018011,100|
|2020-08-06,2020-08-06 09:30:00.0,Q,SYMA,2020-08-06 09:47:20.398,2,NYSE,76.53373290281257,100,76.94424897980778,100|
|2020-08-06,2020-08-06 09:30:00.0,Q,SYMA,2020-08-06 09:56:26.402,3,NYSE,75.12060723753581,100,75.39408189677017,100|
+------------------------------------------------------------------------------------------------------------------+
only showing top 3 rows

✓ Successfully processed 300 records from CSV Directory 2 (NYSE 2020-08-06)
Sample processed data:
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|trade_dt  |file_tm              |record_type|symbol|event_tm               |event_seq_nb|exchange|bid_pr|bid_size|ask_pr|ask_size|partition|
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|2020-08-06|2020-08-06 09:30:00.0|Q          |SYMA  |2020-08-06 09:39:01.293|1           |NYSE    |77.68 |100     |78.44 |100     |Q        |
|2020-08-06|2020-08-06 09:30:00.0|Q          |SYMA  |2020-08-06 09:47:20.398|2           |NYSE    |76.53 |100     |76.94 |100     |Q        |
|2020-08-06|2020-08-06 09:30:00.0|Q          |SYMA  |2020-08-06 09:56:26.402|3           |NYSE    |75.12 |100     |75.39 |100     |Q        |
|2020-08-06|2020-08-06 09:30:00.0|Q          |SYMA  |2020-08-06 10:03:59.522|4           |NYSE    |74.86 |100     |75.77 |100     |Q        |
|2020-08-06|2020-08-06 09:30:00.0|Q          |SYMA  |2020-08-06 10:09:53.165|5           |NYSE    |77.78 |100     |78.80 |100     |Q        |
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
only showing top 5 rows

Found 1 .txt files in JSON Directory 1 (NASDAQ 2020-08-05)

--- Processing JSON Directory 1 (NASDAQ 2020-08-05) ---
Found 300 lines in JSON Directory 1 (NASDAQ 2020-08-05)
Sample raw lines:
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|value                                                                                                                                                                                                                                                       |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|{"trade_dt":"2020-08-05","file_tm":"2020-08-05 09:30:00.000","event_type":"Q","symbol":"SYMA","event_tm":"2020-08-05 09:36:55.284","event_seq_nb":1,"exchange":"NASDAQ","bid_pr":76.10016521142818,"bid_size":100,"ask_pr":77.9647975908747,"ask_size":100} |
|{"trade_dt":"2020-08-05","file_tm":"2020-08-05 09:30:00.000","event_type":"Q","symbol":"SYMA","event_tm":"2020-08-05 09:42:32.247","event_seq_nb":2,"exchange":"NASDAQ","bid_pr":75.44372945251948,"bid_size":100,"ask_pr":75.94452858561046,"ask_size":100}|
|{"trade_dt":"2020-08-05","file_tm":"2020-08-05 09:30:00.000","event_type":"Q","symbol":"SYMA","event_tm":"2020-08-05 09:48:06.767","event_seq_nb":3,"exchange":"NASDAQ","bid_pr":78.84798564828422,"bid_size":100,"ask_pr":80.69114407667608,"ask_size":100}|
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 3 rows

Successfully parsed 300 JSON records
JSON schema:
root
 |-- ask_pr: double (nullable = true)
 |-- ask_size: long (nullable = true)
 |-- bid_pr: double (nullable = true)
 |-- bid_size: long (nullable = true)
 |-- event_seq_nb: long (nullable = true)
 |-- event_tm: string (nullable = true)
 |-- event_type: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- execution_id: string (nullable = true)
 |-- file_tm: string (nullable = true)
 |-- price: double (nullable = true)
 |-- size: long (nullable = true)
 |-- symbol: string (nullable = true)
 |-- trade_dt: string (nullable = true)

✓ Successfully processed 300 records from JSON Directory 1 (NASDAQ 2020-08-05)
Sample processed data:
+----------+-----------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|trade_dt  |file_tm                |record_type|symbol|event_tm               |event_seq_nb|exchange|bid_pr|bid_size|ask_pr|ask_size|partition|
+----------+-----------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|2020-08-05|2020-08-05 09:30:00.000|Q          |SYMA  |2020-08-05 09:36:55.284|1           |NASDAQ  |76.10 |100     |77.96 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.000|Q          |SYMA  |2020-08-05 09:42:32.247|2           |NASDAQ  |75.44 |100     |75.94 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.000|Q          |SYMA  |2020-08-05 09:48:06.767|3           |NASDAQ  |78.85 |100     |80.69 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.000|Q          |SYMA  |2020-08-05 09:53:09.803|4           |NASDAQ  |74.98 |100     |76.16 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.000|Q          |SYMA  |2020-08-05 10:00:10.866|5           |NASDAQ  |76.71 |100     |77.86 |100     |Q        |
+----------+-----------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
only showing top 5 rows

Found 1 .txt files in JSON Directory 2 (NASDAQ 2020-08-06)

--- Processing JSON Directory 2 (NASDAQ 2020-08-06) ---
Found 300 lines in JSON Directory 2 (NASDAQ 2020-08-06)
Sample raw lines:
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|value                                                                                                                                                                                                                                                       |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|{"trade_dt":"2020-08-06","file_tm":"2020-08-06 09:30:00.000","event_type":"Q","symbol":"SYMA","event_tm":"2020-08-06 09:38:08.093","event_seq_nb":1,"exchange":"NASDAQ","bid_pr":78.13370587077013,"bid_size":100,"ask_pr":79.8251633824899,"ask_size":100} |
|{"trade_dt":"2020-08-06","file_tm":"2020-08-06 09:30:00.000","event_type":"Q","symbol":"SYMA","event_tm":"2020-08-06 09:46:05.163","event_seq_nb":2,"exchange":"NASDAQ","bid_pr":76.52304470696788,"bid_size":100,"ask_pr":76.57240785476783,"ask_size":100}|
|{"trade_dt":"2020-08-06","file_tm":"2020-08-06 09:30:00.000","event_type":"Q","symbol":"SYMA","event_tm":"2020-08-06 09:52:14.798","event_seq_nb":3,"exchange":"NASDAQ","bid_pr":78.74535582037817,"bid_size":100,"ask_pr":79.09279949812425,"ask_size":100}|
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 3 rows

Successfully parsed 300 JSON records
JSON schema:
root
 |-- ask_pr: double (nullable = true)
 |-- ask_size: long (nullable = true)
 |-- bid_pr: double (nullable = true)
 |-- bid_size: long (nullable = true)
 |-- event_seq_nb: long (nullable = true)
 |-- event_tm: string (nullable = true)
 |-- event_type: string (nullable = true)
 |-- exchange: string (nullable = true)
 |-- execution_id: string (nullable = true)
 |-- file_tm: string (nullable = true)
 |-- price: double (nullable = true)
 |-- size: long (nullable = true)
 |-- symbol: string (nullable = true)
 |-- trade_dt: string (nullable = true)

✓ Successfully processed 300 records from JSON Directory 2 (NASDAQ 2020-08-06)
Sample processed data:
+----------+-----------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|trade_dt  |file_tm                |record_type|symbol|event_tm               |event_seq_nb|exchange|bid_pr|bid_size|ask_pr|ask_size|partition|
+----------+-----------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|2020-08-06|2020-08-06 09:30:00.000|Q          |SYMA  |2020-08-06 09:38:08.093|1           |NASDAQ  |78.13 |100     |79.83 |100     |Q        |
|2020-08-06|2020-08-06 09:30:00.000|Q          |SYMA  |2020-08-06 09:46:05.163|2           |NASDAQ  |76.52 |100     |76.57 |100     |Q        |
|2020-08-06|2020-08-06 09:30:00.000|Q          |SYMA  |2020-08-06 09:52:14.798|3           |NASDAQ  |78.75 |100     |79.09 |100     |Q        |
|2020-08-06|2020-08-06 09:30:00.000|Q          |SYMA  |2020-08-06 09:58:51.806|4           |NASDAQ  |75.61 |100     |76.95 |100     |Q        |
|2020-08-06|2020-08-06 09:30:00.000|Q          |SYMA  |2020-08-06 10:07:40.796|5           |NASDAQ  |77.45 |100     |78.73 |100     |Q        |
+----------+-----------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
only showing top 5 rows


--- Combining 4 DataFrames ---
✓ Total combined records: 1200

Record type distribution:
+---------+-----+
|partition|count|
+---------+-----+
|        Q| 1080|
|        T|  120|
+---------+-----+


Exchange distribution:
+--------+-----+
|exchange|count|
+--------+-----+
|    NYSE|  600|
|  NASDAQ|  600|
+--------+-----+


Sample of combined data:
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|trade_dt  |file_tm              |record_type|symbol|event_tm               |event_seq_nb|exchange|bid_pr|bid_size|ask_pr|ask_size|partition|
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 09:34:51.505|1           |NYSE    |75.30 |100     |75.36 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 09:40:52.586|2           |NYSE    |77.21 |100     |78.91 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 09:50:04.681|3           |NYSE    |77.16 |100     |77.33 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 09:57:46.343|4           |NYSE    |79.30 |100     |80.08 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 10:06:50.886|5           |NYSE    |77.86 |100     |78.31 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 10:11:43.839|6           |NYSE    |78.75 |100     |80.33 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 10:17:02.044|7           |NYSE    |77.17 |100     |77.98 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 10:23:58.216|8           |NYSE    |78.07 |100     |78.81 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|Q          |SYMA  |2020-08-05 10:31:40.057|9           |NYSE    |76.70 |100     |78.57 |100     |Q        |
|2020-08-05|2020-08-05 09:30:00.0|T          |SYMA  |2020-08-05 10:37:21.581|10          |NYSE    |79.19 |912     |NULL  |NULL    |T        |
+----------+---------------------+-----------+------+-----------------------+------------+--------+------+--------+------+--------+---------+
only showing top 10 rows


Writing processed data to: /mnt/adlsgen2/output/processed_data
✓ Data successfully written to output location

--- Sample Analytics ---
+-----------+------------+--------------+----------------+
|record_type|record_count|unique_symbols|unique_exchanges|
+-----------+------------+--------------+----------------+
|          Q|        1080|             3|               2|
|          T|         120|             3|               2|
+-----------+------------+--------------+----------------+

🎉 Data processing completed successfully!

--- Script execution completed ---